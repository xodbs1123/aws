### Amazon S3 - Object Encryption ###
- S3 버킷 내 객체를 암호화하는 방법은 4가지
- Server-Side Encryption (SSE)

![](https://velog.velcdn.com/images/xodbs1123/post/8d31b79c-6fc1-48fa-8330-3faae5ca51c9/image.png)

 - 서버 측 암호화 (SSE-E3)
    - AWS에 의해 서버 측에서 암호화 됨
    - AES-256 보안 유형으로 암호화 이루어짐
    - 헤더는 "x-amz-server-side-encryption":"AES256"으로 설정해서 SSE-S3 매커니즘으로 객체를 암호화하도록 S3에 요청해야 함

![](https://velog.velcdn.com/images/xodbs1123/post/4663fd5f-8fb7-4d6d-bd8d-8a5786fab503/image.png)    

  - KMS 키를 사용하여 암호화 키 관리 (SSE-KMS)
    - KMS로 사용자 자신의 키를 직접 관리하는 방식
    - KMS 내에서 직접 키를 생성하고 CloudTrail을 사용해서 사용량 감사 가능
    - 누군가 KMS에서 키를 사용하면 CloudTrail에서 기록 확인 가능
    - 헤더는 "x-amz-server-side-encryption":"aws:kms"로 지정하면 서버에서 객체를 암호화
    - s3 버킷에서 파일을 읽으려면 객체 자체에 대한 액세스뿐만 아니라 KMS 키에 대한 액세스도 필요
    - 처리량이 매우 높은 S3 버킷이 있고 모든 파일이 KMS 키로 암호화 되어있으면 스로틀링 등의 오류가 발생할 수 있음
    
![](https://velog.velcdn.com/images/xodbs1123/post/7d087550-88ef-435a-9c11-4097d36b0180/image.png)
  
  - 고객이 제공하는 키를 사용 (SSE-C)
    - AWS 외부에서 키 관리
    - 제공된 암호화 키는 Amazon S3에 저장되지 않고 사용 후 폐기
    - Amazon S3로 키를 전송하기 때문에 HTTPS를 사용해야하고 요청을 전송할 때마다 HTTP 헤더에 키를 포함하여 전달해야 함
    
 ![](https://velog.velcdn.com/images/xodbs1123/post/1e526026-71d2-44a5-9ac6-f3a29334b981/image.png)   

- Client-Side Encryption
  - 클라이언트 측에서 모든 것을 암호화한 다음 Amazon S3에 업로드
  - 데이터를 Amazon S3로 보내기 전 클라이언트가 직접 암호화
  - 암호화한 데이터는 S3에서 다시 가져올 수 있음
  - 데이터 복호화는 S3 외부의 클라이언트에서 수행됨
  - 즉, 클라이언트가 전적으로 키와 암호화 주기를 관리
- 전송 중 암호화 ( Encryption in transit, SSL/TLS )
  - Amazon S3 버킷 두 개의 엔드포인트
    - HTTP Endpoint - non encrypted
    - HTTPS Endpoint - encryption in flight

` 실습은 Udemy 강의 참조!! `

### Amazon S3 - Default Encryption VS Bucket POlicies ###

![](https://velog.velcdn.com/images/xodbs1123/post/cf4859e0-20d2-47bc-a505-6c2d2342d5b6/image.png)

- 왼쪽 정책은 SSE-S3를 강제로 적용
  - 헤더가 AES256과 같지 않으면 API 호출을 거부하도록 구성
- 오른쪽 정책은 암호화되지 않은 객체만 전무 강제로 적용
  - 버킷 정책임
